---
title: "Setting up your project"
output: rmarkdown::html_vignette
description: >
  This article covers the aditional steps important in dealing with
  ARU recordings, however they often fall outside the standard workflow.
vignette: >
  %\VignetteIndexEntry{Setting up your project}
  %\VignetteEngine{knitr::rmarkdown}
  %\VignetteEncoding{UTF-8}
---

```{r, include = FALSE}
library(ARUtools)
knitr::opts_chunk$set(
  collapse = TRUE,
  comment = "#>"
)
options(tibble.print_min = 4L, tibble.print_max = 4L)
```


## Setting up your folder structure

While most of `ARUtools` focuses on processing recordings once they are 
transferred from ARUs, setting up a folder structure can greatly increase efficiency
in transferring files.

To set up a folder structure you will need the hierarchical structure you wish to
use and the list of sites/arus you are processing.

```{r, eval=F}
site_list <- 
example_sites |> 
  tidyr::separate(Sites, into = c("plot", "site"), sep = "_", remove = F) |> 
  dplyr::select(site_id=Sites, plot, site)
  
  
tmp_dir <- tempdir(check = T)

create_directory_structure(hexagons = site_list$plot,
                           units = site_list$site_id, 
                           base_dir = tmp_dir)

```
This should create a series of folders with plot at the main level and site in 
the subdirectory below that.

```{r, eval=F}
list.dirs(tmp_dir, full.names = F)
```
Note that this will not work for all project structures and you should think carefully about 
how you want to set up your file names, folder structure and spatial information
before you deploy any ARUs.

## Wind processing

One issue that can cause difficulty in interpretation of acoustic recordings is
wind. Wind can mask bird songs and even is a potential danger to interpreters' ears.

The University Of Salford Acoustics Research Centre developed a softare program [WindNoiseDetection](https://github.com/kenders2000/WindNoiseDetection?tab=readme-ov-file#university-of-salford-acoustics-research-centre) that detects wind in wave files. 

I have developed a [fork of the software](https://github.com/dhope/WindNoiseDetection) 
that has added the ability to run multiple files at once using parallel processing
and to provide a list of files to process.

Running the program requires fairly complex setup in Windows as is uses `C` and 
`C++` and requires `Cygwin` to run.

However if you do get it running, `ARUtools` includes a couple helper functions to
process your metadata and set it up for running with WindNoiseDetection.

```{r}
wind_files <- 
  prep_for_wind_detection(wav_files = example_clean$path,
                                     output_directory = "./wind_files/", 
                                     site_pattern = create_pattern_site_id( p_digits = c(2,3), sep = "_", 
                                                                            s_digits = c(1,2)),
                                     write_to_file = F, chunk_size = NULL)
```





## Assign tasks

## Misc functions
soxSpectrogram()
play_random_track()
