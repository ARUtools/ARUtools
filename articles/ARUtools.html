<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="If you're just digging into procesing your ARU files or want  to plan your folder structure, start here. You'll get a sense of  what you need to have prepared before you start and how to read in the file metadata from your ARU files.
">
<title>Getting started with ARUtools • ARUtools</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png">
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Getting started with ARUtools">
<meta property="og:description" content="If you're just digging into procesing your ARU files or want  to plan your folder structure, start here. You'll get a sense of  what you need to have prepared before you start and how to read in the file metadata from your ARU files.
">
<meta property="og:image" content="http://arutools.github.io/ARUtools/logo.png">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light" data-bs-theme="light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">ARUtools</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="Released version">0.6.2</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="active nav-item">
  <a class="nav-link" href="../articles/ARUtools.html">Get started</a>
</li>
<li class="nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../articles/SubSample.html">Subsampling recordings</a>
    <div class="dropdown-divider"></div>
    <h6 class="dropdown-header" data-toc-skip>Customization</h6>
    <a class="dropdown-item" href="../articles/customizing.html">Customizing `clean_metadata()`</a>
    <a class="dropdown-item" href="../articles/spatial.html">Working with spatial data</a>
    <a class="dropdown-item" href="../articles/timezones.html">Dealing with Timezones</a>
    <div class="dropdown-divider"></div>
    <a class="dropdown-item" href="../articles/index.html">More articles...</a>
  </div>
</li>
<li class="nav-item">
  <a class="nav-link" href="../news/index.html">Changelog</a>
</li>
      </ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav">
<li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/arutools/ARUtools/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>

    
  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Getting started with ARUtools</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/arutools/ARUtools/blob/HEAD/vignettes/ARUtools.Rmd" class="external-link"><code>vignettes/ARUtools.Rmd</code></a></small>
      <div class="d-none name"><code>ARUtools.Rmd</code></div>
    </div>

    
    
<p>The ARUtools package aims to make processing of large quantities of
acoustic recordings easier through automation of metadata processing and
sub-sampling of recordings.</p>
<p>Prior to working on your ARU recordings or meta data you must:</p>
<ul>
<li><p>Know your goals of interpreting recordings</p></li>
<li><p>Transferred your recordings to a suitable and organized location
for processing</p></li>
<li><p>Prepare your site information so it can be linked with the
recordings</p></li>
</ul>
<p>This introduction will walk through the first few steps of extracting
the metadata, adding site information, and calculating sunrise and
sunset information.</p>
<div class="section level2">
<h2 id="read-file-metadata">Read file metadata<a class="anchor" aria-label="anchor" href="#read-file-metadata"></a>
</h2>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://arutools.github.io/ARUtools/" class="external-link">ARUtools</a></span><span class="op">)</span></span></code></pre></div>
<p>Let’s use some example data to get started.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">example_files</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] "a_BARLT10962_P01_1/P01_1_20200502T050000_ARU.wav"</span></span>
<span><span class="co">#&gt; [2] "a_BARLT10962_P01_1/P01_1_20200503T052000_ARU.wav"</span></span>
<span><span class="co">#&gt; [3] "a_S4A01234_P02_1/P02_1_20200504T052500_ARU.wav"  </span></span>
<span><span class="co">#&gt; [4] "a_S4A01234_P02_1/P02_1_20200505T073000_ARU.wav"  </span></span>
<span><span class="co">#&gt; [5] "a_BARLT10962_P03_1/P03_1_20200506T100000_ARU.wav"</span></span>
<span><span class="co">#&gt; [6] "a_BARLT11111_P04_1/P04_1_20200506T050000_ARU.wav"</span></span></code></pre></div>
<p>This is a list of hypothetical ARU files from different sites, and
using different ARUs. This is fairly messily organized data in that
there is no clear structure to the folders and there appear to be
unneeded characters in the files. However give the standard structure of
site names, ARU ID codes, and datetime stamps, we can extract that
information from the file structure alone.</p>
<p>First things first, we’ll clean up the meta data associated with the
files.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">m</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/clean_metadata.html">clean_metadata</a></span><span class="op">(</span>project_files <span class="op">=</span> <span class="va">example_files</span><span class="op">)</span></span>
<span><span class="co">#&gt; Extracting ARU info...</span></span>
<span><span class="co">#&gt; Extracting Dates and Times...</span></span></code></pre></div>
<p>Because our example files follow the standard formats for Site ID,
ARU Id, and date/time, we can extract all the information without having
to change any of the default arguments.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">m</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 42 × 8</span></span></span>
<span><span class="co">#&gt;   file_name   type  path  aru_type aru_id site_id date_time           date      </span></span>
<span><span class="co">#&gt;   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>       <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;dttm&gt;</span>              <span style="color: #949494; font-style: italic;">&lt;date&gt;</span>    </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">1</span> P01_1_2020… wav   a_BA… BarLT    BARLT… P01_1   2020-05-02 <span style="color: #949494;">05:00:00</span> 2020-05-02</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">2</span> P01_1_2020… wav   a_BA… BarLT    BARLT… P01_1   2020-05-03 <span style="color: #949494;">05:20:00</span> 2020-05-03</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">3</span> P02_1_2020… wav   a_S4… SongMet… S4A01… P02_1   2020-05-04 <span style="color: #949494;">05:25:00</span> 2020-05-04</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">4</span> P02_1_2020… wav   a_S4… SongMet… S4A01… P02_1   2020-05-05 <span style="color: #949494;">07:30:00</span> 2020-05-05</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># ℹ 38 more rows</span></span></span></code></pre></div>
<p>If you were reading directly from files you would assign a base
directory and then have <code>clean_metadata</code> read the files in
that folder and sub-folders.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">base_directory</span> <span class="op">&lt;-</span> <span class="st">"/path/to/project/files/"</span></span>
<span><span class="va">m</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/clean_metadata.html">clean_metadata</a></span><span class="op">(</span>project_dir <span class="op">=</span> <span class="va">base_directory</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="add-coordinates">Add coordinates<a class="anchor" aria-label="anchor" href="#add-coordinates"></a>
</h2>
<p>Next, we want to add our coordinates to this data.</p>
<p>If your data has GPS logs included, they would have been detected in
the above step and you could now use <code>g &lt;- clean_gps(m)</code>
to create a list of GPS coordinates.</p>
<p>However, many models of ARUs do not have an internal GPS and those
that do, may not accurately record the location where the ARU is
deployed to. Therefore we recommend that you create a site index file to
manually record deployment locations, like this one.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">example_sites</span></span>
<span><span class="co">#&gt;    Sites Date_set_out Date_removed        ARU    lon    lat Plots Subplot</span></span>
<span><span class="co">#&gt; 1  P01_1   2020-05-01   2020-05-03 BARLT10962 -85.03 50.010 Plot1       a</span></span>
<span><span class="co">#&gt; 2  P02_1   2020-05-03   2020-05-05   S4A01234 -87.45 52.680 Plot1       a</span></span>
<span><span class="co">#&gt; 3  P03_1   2020-05-05   2020-05-06 BARLT10962 -90.38 48.990 Plot2       a</span></span>
<span><span class="co">#&gt; 4  P04_1   2020-05-05   2020-05-07 BARLT11111 -85.53 45.000 Plot2       a</span></span>
<span><span class="co">#&gt; 5  P05_1   2020-05-06   2020-05-07 BARLT10962 -88.45 51.050 Plot3       b</span></span>
<span><span class="co">#&gt; 6  P06_1   2020-05-08   2020-05-09 BARLT10962 -90.08 52.000 Plot1       a</span></span>
<span><span class="co">#&gt; 7  P07_1   2020-05-08   2020-05-10   S4A01234 -86.03 50.450 Plot1       a</span></span>
<span><span class="co">#&gt; 8  P08_1   2020-05-10   2020-05-11 BARLT10962 -84.45 48.999 Plot2       a</span></span>
<span><span class="co">#&gt; 9  P09_1   2020-05-10   2020-05-11   S4A02222 -91.38 45.000 Plot2       a</span></span>
<span><span class="co">#&gt; 10 P10_1   2020-05-10   2020-05-11   S4A03333 -90.00 50.010 Plot3       b</span></span></code></pre></div>
<p>While you can simply specify a single date, it is recommended that
you use both a start date and an end date for the best matching. This is
critical if you are moving your ARUs during a season.</p>
<p>Now let’s clean up this list so we can add these sites to our
metadata.</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">sites</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/clean_site_index.html">clean_site_index</a></span><span class="op">(</span><span class="va">example_sites</span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #BBBB00; font-weight: bold;">Error</span><span style="font-weight: bold;"> in `clean_site_index()`:</span></span></span>
<span><span class="co">#&gt; <span style="color: #BBBB00;">!</span> Problems with data `site_index`:</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">•</span> Column 'site_id' does not exist</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">•</span> Column 'date' does not exist</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">•</span> Column 'aru_id' does not exist</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">•</span> Column 'longitude' does not exist</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">•</span> Column 'latitude' does not exist</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">•</span> See ?clean_site_index</span></span></code></pre></div>
<p>Ooops! We can see right away that <code><a href="../reference/clean_site_index.html">clean_site_index()</a></code>
expects the data to be in a particular format. Luckily we can let it
know if we’ve used a different format.</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">sites</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/clean_site_index.html">clean_site_index</a></span><span class="op">(</span><span class="va">example_sites</span>,</span>
<span>  name_aru_id <span class="op">=</span> <span class="st">"ARU"</span>,</span>
<span>  name_site_id <span class="op">=</span> <span class="st">"Sites"</span>,</span>
<span>  name_date_time <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Date_set_out"</span>, <span class="st">"Date_removed"</span><span class="op">)</span>,</span>
<span>  name_coords <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"lon"</span>, <span class="st">"lat"</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span><span class="co">#&gt; There are overlapping date ranges</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">•</span> Shifting start/end times to 'noon'</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">•</span> Skip this with `resolve_overlaps = FALSE`</span></span></code></pre></div>
<p>Hmm, that’s an interesting message! This means that some of our
deployment dates overlap. ARUtools assumes that if you set out an ARU on
a specific day, you probably didn’t set it out at midnight (i.e. the
very start of that day). Since we assume you are likely using ARUs for
recording in the early morning or late at night, we shift the dates
start/end times to noon as an estimate of when the ARU was likely
deployed.</p>
<p>If your ARU was deployed at midnight, use
<code>resolve_ovelaps = FALSE</code>. Or, if you know the exact time
your ARU was deployed, use a date/time rather than just a date in your
site index.</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">sites</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 10 × 8</span></span></span>
<span><span class="co">#&gt;   site_id aru_id   date_time_start     date_time_end       date_start date_end  </span></span>
<span><span class="co">#&gt;   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;dttm&gt;</span>              <span style="color: #949494; font-style: italic;">&lt;dttm&gt;</span>              <span style="color: #949494; font-style: italic;">&lt;date&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;date&gt;</span>    </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">1</span> P01_1   BARLT10… 2020-05-01 <span style="color: #949494;">12:00:00</span> 2020-05-03 <span style="color: #949494;">12:00:00</span> 2020-05-01 2020-05-03</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">2</span> P02_1   S4A01234 2020-05-03 <span style="color: #949494;">12:00:00</span> 2020-05-05 <span style="color: #949494;">12:00:00</span> 2020-05-03 2020-05-05</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">3</span> P03_1   BARLT10… 2020-05-05 <span style="color: #949494;">12:00:00</span> 2020-05-06 <span style="color: #949494;">12:00:00</span> 2020-05-05 2020-05-06</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">4</span> P04_1   BARLT11… 2020-05-05 <span style="color: #949494;">12:00:00</span> 2020-05-07 <span style="color: #949494;">12:00:00</span> 2020-05-05 2020-05-07</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># ℹ 6 more rows</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># ℹ 2 more variables: longitude &lt;dbl&gt;, latitude &lt;dbl&gt;</span></span></span></code></pre></div>
<p>Note that we’ve lost a couple of non-standard columns:
<code>Plots</code> and <code>Subplot</code>.</p>
<p>We can retain these by specifying <code>cols_extra</code>.</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">sites</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/clean_site_index.html">clean_site_index</a></span><span class="op">(</span><span class="va">example_sites</span>,</span>
<span>  name_aru_id <span class="op">=</span> <span class="st">"ARU"</span>,</span>
<span>  name_site_id <span class="op">=</span> <span class="st">"Sites"</span>,</span>
<span>  name_date_time <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Date_set_out"</span>, <span class="st">"Date_removed"</span><span class="op">)</span>,</span>
<span>  name_coords <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"lon"</span>, <span class="st">"lat"</span><span class="op">)</span>,</span>
<span>  name_extra <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Plots"</span>, <span class="st">"Subplot"</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span><span class="co">#&gt; There are overlapping date ranges</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">•</span> Shifting start/end times to 'noon'</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">•</span> Skip this with `resolve_overlaps = FALSE`</span></span>
<span><span class="va">sites</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 10 × 10</span></span></span>
<span><span class="co">#&gt;   site_id aru_id   date_time_start     date_time_end       date_start date_end  </span></span>
<span><span class="co">#&gt;   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;dttm&gt;</span>              <span style="color: #949494; font-style: italic;">&lt;dttm&gt;</span>              <span style="color: #949494; font-style: italic;">&lt;date&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;date&gt;</span>    </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">1</span> P01_1   BARLT10… 2020-05-01 <span style="color: #949494;">12:00:00</span> 2020-05-03 <span style="color: #949494;">12:00:00</span> 2020-05-01 2020-05-03</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">2</span> P02_1   S4A01234 2020-05-03 <span style="color: #949494;">12:00:00</span> 2020-05-05 <span style="color: #949494;">12:00:00</span> 2020-05-03 2020-05-05</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">3</span> P03_1   BARLT10… 2020-05-05 <span style="color: #949494;">12:00:00</span> 2020-05-06 <span style="color: #949494;">12:00:00</span> 2020-05-05 2020-05-06</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">4</span> P04_1   BARLT11… 2020-05-05 <span style="color: #949494;">12:00:00</span> 2020-05-07 <span style="color: #949494;">12:00:00</span> 2020-05-05 2020-05-07</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># ℹ 6 more rows</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># ℹ 4 more variables: longitude &lt;dbl&gt;, latitude &lt;dbl&gt;, Plots &lt;chr&gt;,</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;">#   Subplot &lt;chr&gt;</span></span></span></code></pre></div>
<p>We can even be fancy and rename them for consistency by using named
vectors.</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">sites</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/clean_site_index.html">clean_site_index</a></span><span class="op">(</span><span class="va">example_sites</span>,</span>
<span>  name_aru_id <span class="op">=</span> <span class="st">"ARU"</span>,</span>
<span>  name_site_id <span class="op">=</span> <span class="st">"Sites"</span>,</span>
<span>  name_date_time <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Date_set_out"</span>, <span class="st">"Date_removed"</span><span class="op">)</span>,</span>
<span>  name_coords <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"lon"</span>, <span class="st">"lat"</span><span class="op">)</span>,</span>
<span>  name_extra <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"plot"</span> <span class="op">=</span> <span class="st">"Plots"</span>, <span class="st">"subplot"</span> <span class="op">=</span> <span class="st">"Subplot"</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span><span class="co">#&gt; There are overlapping date ranges</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">•</span> Shifting start/end times to 'noon'</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">•</span> Skip this with `resolve_overlaps = FALSE`</span></span>
<span><span class="va">sites</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 10 × 10</span></span></span>
<span><span class="co">#&gt;   site_id aru_id   date_time_start     date_time_end       date_start date_end  </span></span>
<span><span class="co">#&gt;   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;dttm&gt;</span>              <span style="color: #949494; font-style: italic;">&lt;dttm&gt;</span>              <span style="color: #949494; font-style: italic;">&lt;date&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;date&gt;</span>    </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">1</span> P01_1   BARLT10… 2020-05-01 <span style="color: #949494;">12:00:00</span> 2020-05-03 <span style="color: #949494;">12:00:00</span> 2020-05-01 2020-05-03</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">2</span> P02_1   S4A01234 2020-05-03 <span style="color: #949494;">12:00:00</span> 2020-05-05 <span style="color: #949494;">12:00:00</span> 2020-05-03 2020-05-05</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">3</span> P03_1   BARLT10… 2020-05-05 <span style="color: #949494;">12:00:00</span> 2020-05-06 <span style="color: #949494;">12:00:00</span> 2020-05-05 2020-05-06</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">4</span> P04_1   BARLT11… 2020-05-05 <span style="color: #949494;">12:00:00</span> 2020-05-07 <span style="color: #949494;">12:00:00</span> 2020-05-05 2020-05-07</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># ℹ 6 more rows</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># ℹ 4 more variables: longitude &lt;dbl&gt;, latitude &lt;dbl&gt;, plot &lt;chr&gt;,</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;">#   subplot &lt;chr&gt;</span></span></span></code></pre></div>
<p>Now let’s add this site-related information to our metadata.</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">m</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/add_sites.html">add_sites</a></span><span class="op">(</span><span class="va">m</span>, <span class="va">sites</span><span class="op">)</span></span>
<span><span class="co">#&gt; Joining by columns `date_time_start` and `date_time_end`</span></span>
<span><span class="va">m</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 42 × 12</span></span></span>
<span><span class="co">#&gt;   file_name   type  path  aru_type aru_id site_id date_time           date      </span></span>
<span><span class="co">#&gt;   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>       <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;dttm&gt;</span>              <span style="color: #949494; font-style: italic;">&lt;date&gt;</span>    </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">1</span> P01_1_2020… wav   a_BA… BarLT    BARLT… P01_1   2020-05-02 <span style="color: #949494;">05:00:00</span> 2020-05-02</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">2</span> P01_1_2020… wav   a_BA… BarLT    BARLT… P01_1   2020-05-03 <span style="color: #949494;">05:20:00</span> 2020-05-03</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">3</span> P02_1_2020… wav   a_S4… SongMet… S4A01… P02_1   2020-05-04 <span style="color: #949494;">05:25:00</span> 2020-05-04</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">4</span> P02_1_2020… wav   a_S4… SongMet… S4A01… P02_1   2020-05-05 <span style="color: #949494;">07:30:00</span> 2020-05-05</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># ℹ 38 more rows</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># ℹ 4 more variables: longitude &lt;dbl&gt;, latitude &lt;dbl&gt;, plot &lt;chr&gt;,</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;">#   subplot &lt;chr&gt;</span></span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="calculate-times-to-sunrise-and-sunset">Calculate times to sunrise and sunset<a class="anchor" aria-label="anchor" href="#calculate-times-to-sunrise-and-sunset"></a>
</h2>
<p>Great! We have all the site-related information to describe that
recording.</p>
<p>Now to prepare for our selection procedure, the last thing we need to
do is calculate the time to sunrise or sunset.</p>
<p>Here we need to be clear about what timezone the ARU unit was
recording times as.</p>
<p>There are two options.</p>
<p>The first option is that all ARUs were set up at home base before
deployment. In this case it’s possible they were deployed in a location
with a different timezone than what they were recording in. This doesn’t
matter, as long as you specify the programmed timezone here. In this
case, use <code>tz = "America/Toronto"</code>, or whichever time zone
was used. Note that timezones must be one of
<code><a href="https://rdrr.io/r/base/timezones.html" class="external-link">OlsonNames()</a></code>.</p>
<p>The second option is that each ARU unit was set up to record in the
local timezone where it was placed. If this is the case, specify
<code>tz = "local"</code> and the <code><a href="../reference/calc_sun.html">calc_sun()</a></code> function will
use coordinates to determine local timezones.</p>
<p>(See the Dealing with Timezones vignette for more details).</p>
<p>In our example, let’s assume that the ARUs were set up in each
location they were deployed. So we’ll use <code>tz = "local"</code>, the
default setting.</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">m</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/calc_sun.html">calc_sun</a></span><span class="op">(</span><span class="va">m</span><span class="op">)</span></span>
<span><span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://pillar.r-lib.org/reference/glimpse.html" class="external-link">glimpse</a></span><span class="op">(</span><span class="va">m</span><span class="op">)</span></span>
<span><span class="co">#&gt; Rows: 42</span></span>
<span><span class="co">#&gt; Columns: 15</span></span>
<span><span class="co">#&gt; $ file_name <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> "P01_1_20200502T050000_ARU.wav", "P01_1_20200503T052000_ARU.…</span></span>
<span><span class="co">#&gt; $ type      <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> "wav", "wav", "wav", "wav", "wav", "wav", "wav", "wav", "wav…</span></span>
<span><span class="co">#&gt; $ path      <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> "a_BARLT10962_P01_1/P01_1_20200502T050000_ARU.wav", "a_BARLT…</span></span>
<span><span class="co">#&gt; $ aru_type  <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> "BarLT", "BarLT", "SongMeter", "SongMeter", "BarLT", "BarLT"…</span></span>
<span><span class="co">#&gt; $ aru_id    <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> "BARLT10962", "BARLT10962", "S4A01234", "S4A01234", "BARLT10…</span></span>
<span><span class="co">#&gt; $ site_id   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> "P01_1", "P01_1", "P02_1", "P02_1", "P03_1", "P04_1", "P04_1…</span></span>
<span><span class="co">#&gt; $ date_time <span style="color: #949494; font-style: italic;">&lt;dttm&gt;</span> 2020-05-02 05:00:00, 2020-05-03 05:20:00, 2020-05-04 05:25:…</span></span>
<span><span class="co">#&gt; $ date      <span style="color: #949494; font-style: italic;">&lt;date&gt;</span> 2020-05-02, 2020-05-03, 2020-05-04, 2020-05-05, 2020-05-06,…</span></span>
<span><span class="co">#&gt; $ longitude <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> -85.03, -85.03, -87.45, -87.45, -90.38, -85.53, -85.53, -88.…</span></span>
<span><span class="co">#&gt; $ latitude  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> 50.010, 50.010, 52.680, 52.680, 48.990, 45.000, 45.000, 51.0…</span></span>
<span><span class="co">#&gt; $ plot      <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> "Plot1", "Plot1", "Plot1", "Plot1", "Plot2", "Plot2", "Plot2…</span></span>
<span><span class="co">#&gt; $ subplot   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> "a", "a", "a", "a", "a", "a", "a", "b", "a", "a", "a", "a", …</span></span>
<span><span class="co">#&gt; $ tz        <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> "America/Toronto", "America/Toronto", "America/Toronto", "Am…</span></span>
<span><span class="co">#&gt; $ t2sr      <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> -74.933333, -53.216667, -47.250000, 79.616667, 207.133333, -…</span></span>
<span><span class="co">#&gt; $ t2ss      <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> 479.9500, 498.4167, 483.4167, 606.6833, -685.8833, 486.1833,…</span></span></code></pre></div>
<p>Tada! Now we have a complete set of cleaned metadata associated with
each recording.</p>
<p>This is a very simple example and much of the pain in large projects
comes from complications, so be sure to check out
<code><a href="../articles/customizing.html">vignette("customizing")</a></code> and
<code><a href="../articles/spatial.html">vignette("spatial")</a></code> to dig into some of these issues.</p>
</div>
<div class="section level2">
<h2 id="next-steps">Next steps<a class="anchor" aria-label="anchor" href="#next-steps"></a>
</h2>
<p>Now that we have a set of cleaned metadata the next step is to select
recordings. To do this using a random sampling approach check out the
subsampling article <code><a href="../articles/SubSample.html">vignette("SubSample")</a></code>.</p>
</div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p></p>
<p>Developed by David Hope, Steffi LaZerte, Government of Canada.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.8.</p>
</div>

    </footer>
</div>

  

  

  </body>
</html>
